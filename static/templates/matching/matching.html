{% extends 'home/index.html' %}
{% load url from future %}

{% block js %}
    <script src = "{{ STATIC_URL }}/js/epm.js" type = 'text/javascript'></script>    
	<script src = "{{ STATIC_URL }}js/local/epm-matching.js" type = 'text/javascript'></script>
	<script type='text/javascript'>
	    //Define this django-rendered petreport variable as a global javascript variable
		var TARGET_PETREPORT = convert_to_javascript_obj("{{ target_petreport.toJSON }}");
	</script>
{% endblock js %}

{% block head_title %}EPM - Matching {% endblock head_title %}
{% block content_title %} The Matching Interface {% endblock content_title %}

{% block content %}
<div id="matching_body" style="min-height:800px;">
	<div id = "mi_instructions" style ="margin 0 auto; font-size: 14px; font-weight:bold;">
		<p> The matching interface allows you to click and drag potential pet reports to the workspace, which contains empty squares to put potential matches onto. To begin, survey the pet reports on the right that have been analyzed and ranked by the system to resemble a match and place them onto the workspace. When you feel that a potential match can be made, click on the "Propose Pet Match" button in the workspace. Good luck matching!</p>
	</div>

	<div id="nav">
		<ul>
			<li class="active"><a href="#">Suggested Pets</a></li>
			<!-- <li><a href="#">Manual Search</a></li> -->
		</ul>
	</div>

	<!-- Workspace for Placing Pet Report Candidate Matches-->
	<div id="workspace">

		<!-- PetReport Target and Candidates -->
		<div id="prtarget"> 
			<img class='target' src="{{ STATIC_URL }}{{ target_petreport.img_path }}">
			<div class="droppable">
				<div style="text-align:center; padding:5%; margin:20%;">Drag a Pet Report Here</div>
			</div>
		</div>

		<div id="workspace_match_detail">

			<div class = "matching_img"></div>

			<!-- PetReport info -->
			<ul class = "prdpfields"> </ul>

			<!-- Buttons -->
	   		<button id= "button_propose_match"> Propose Match </button>

		</div>
	</div>

	<!-- Container for ML-Ranked Pet Reports -->
	<div id="matching_container">
		<ul id="tiles">
			{% block pet_reports_content %}
				{% if pet_reports_list %}
					{% for pet_report in pet_reports_list %}
						<li class="item" >
							<script> 
							    //Define this django-rendered petreport variable as a global javascript variable
								var CANDIDATE_PETREPORT = convert_to_javascript_obj("{{ pet_report.toJSON }}");
							</script>
							<div id = "prdpdialog">
								<a href= "{% url 'disp_PetReport' pet_report.id %}" name="{{ pet_report.pet_name }}">
									<strong>{{ pet_report.pet_name }}</strong><br/>
									{{ pet_report.status }}: {{ pet_report.pet_type }} <br/>
									Contact : {{ pet_report.proposed_by.user.username }}
									<img src="{{ STATIC_URL }}{{ pet_report.img_path }}"/>
								</a>
							</div>
						</li>	
					{% endfor %}							
				{% else %}
				    <p>No pet reports are available.</p>
				{% endif %}
			{% endblock pet_reports_content %}

			<!-- Pagination -->
			<div class="pagination" align="left">
	   			<div class="step-links" id="footer" align="left">
	        		{% if pet_reports_list.has_previous %}
	           			<a href="?page={{ pet_reports_list.previous_page_number }}">previous</a>
	        		{% endif %}
	        	</div>	
	       		<div class="current" id="footer" align="left">
	            	Page {{ pet_reports_list.number }} of {{ pet_reports_list.paginator.num_pages }}.
	        	</div>
	        	<div class="step-links" id="footer" align="left">	
	        		{% if pet_reports_list.has_next %}
	            		<a href="?page={{ pet_reports_list.next_page_number }}">next</a>
	        		{% endif %}
	        	</div>		
	    	</div>
		</ul>	
	</div>

	{% block chat %}
	{% endblock chat %}
</div>
{% endblock content %}

{% load url from future %} <!-- Need this for forward (future) compatibility with django 1.5 and beyond. -->

<!DOCTYPE html>
<html class = 'no-js' lang = "en">
  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
  <!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
  <!--[if gt IE 8]> <html class="no-js" lang="en"> <![endif]-->
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>{% block head_title %}Pet Match Verification Page{% endblock head_title %}</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />

    <!-- CSS -->
    <!-- EPM Style CSS -->
    <link rel="stylesheet" href="{{ STATIC_URL }}css/style.css" type="text/css"></link>
    <!-- Include the JQuery UI Style CSS -->
    <link rel="stylesheet" href="{{ STATIC_URL }}css/ui-lightness/jquery-ui-1.8.23.custom.css" type="text/css"></link>
    <!-- Include the Reset CSS -->
    <link rel="stylesheet" href="{{ STATIC_URL }}css/reset.css" type="text/css"></link>
    
    <!-- Javascript & JQuery -->
    <!-- jquery original source -->
    <script src="{{ STATIC_URL }}js/jquery-1.8.1.min.js" type="text/javascript"></script>
    <!-- jquery UI original source -->
    <script src="{{ STATIC_URL }}js/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>
    <!-- Include the Browser ID JS plugin -->
    <script src="{{ STATIC_URL }}js/browserid-include.js" type="text/javascript"></script>
    <!-- Include the BlockUI plugin -->
    <script src="{{ STATIC_URL }}js/jquery-blockui.js" type="text/javascript"></script>
    <!-- Include the hoverIntent plug-in -->
    <script src="{{ STATIC_URL }}js/jquery-hoverIntent.js" type="text/javascript"></script>
    <!-- Include the waypoints plug-in -->
    <script src="{{ STATIC_URL }}js/jquery-waypoints.js" type="text/javascript"></script>
    <!-- Include the imagesLoaded plug-in -->
    <script src="{{ STATIC_URL }}js/jquery-imagesloaded.js" type="text/javascript"></script>
    <!-- Include the wookmark plug-in -->
    <script src="{{ STATIC_URL }}js/jquery-wookmark.js" type="text/javascript"></script>

    <!-- General, inheritable JS goes here -->
    <script src = "{{ STATIC_URL }}js/epm.js" type = 'text/javascript'></script>
    <!-- Page-specific JS goes in this block -->
    {% block js %}
    <script src = "{{ STATIC_URL }}js/local/epm-petmatch.js" type = 'text/javascript'></script>
    <script type="text/javascript">

      //Must have these django-rendered variables as global javascript variables in order to refer to them!
      var STATIC_URL = "{{ STATIC_URL }}";
      var VOTED = "{{ user_has_voted }}";
      var USER_ID = "{{ user.id }}";
      var URL_VERIFY_PETMATCH = "/matching/verify_PetMatch/"
      var PETMATCH_ID = "{{ petmatch.id }}";
      var URL_VOTE_PETMATCH = "{% url 'vote_PetMatch' %}";
      var URL_LOGIN = "Log in <a href={% url 'login_User' %}?next={% firstof request.path '/' %} > here.</a>";      


    </script>
    <script type="text/javascript">
        function post_user_response(response){
            var url = URL_VERIFY_PETMATCH+PETMATCH_ID+"/";
            var message =response;
            var csrf_value = $("input").attr("value");
            $.post(url, {"csrfmiddlewaretoken":csrf_value,"message":message},function(data){
               alert("post success!");
             });
              
        }
     </script>
    {% endblock js %}

  </head>

  <body>
    <div id="pmdp_back" style="width:auto;">

 <!--      {% if user_has_voted %}
      <p style = "text-align:center; color:gray; font-size:14pt;"> You have already voted for this PetMatch. </p>
      {% endif %} -->
      <p class = "verification_message">
        This match could potentially be a success! Let us know what you think.
      </p>
          <!-- Buttons -->
        <div id ="prdp_buttons">

          {% csrf_token %}
          <a class = "prdp_eachbutton"  title="Yes, this is a perfect match" style="float:left;cursor:pointer;margin-left:25%" onclick="post_user_response('yes')">
            
            Yes, this is a perfect match
          </a>
          <a class = "prdp_eachbutton" style="float:right;margin-right:25%" onclick="post_user_response('no')" >No, I do not agree with this match</a></br>
        </div>
      

      <!-- PMDP Match Container - contains PMDP Images and Attributes -->
      <div id = "pmdp_match_container" style="width:auto;">

        <!-- Lost PetReport -->
        <div class = "pmdp_pet_container" style="margin-left:5px;float:left;width:48%;">

          <!-- Lost PetReport Title -->
          <div id="match_title">
            <div style="float:left"> {% if petmatch.lost_pet.pet_name %} {{ petmatch.lost_pet.pet_name }} {% endif %} </div>
            <div style="float:right"> {{ petmatch.lost_pet.status }} </div>
          </div> <br/>

          <!-- Lost PetReport Image -->
          <img src="{{ STATIC_URL }}{{ petmatch.lost_pet.img_path }}"/>

          <!-- Lost PetReport Info -->
          <ul>
            <li><b>Pet Name:</b> {{ petmatch.lost_pet.pet_name }}</li>
            <li><b>Pet Type:</b> {{ petmatch.lost_pet.pet_type }}</li>
            <li><b>Lost/Found:</b> {{ petmatch.lost_pet.status }}</li>
            <li><b>Contact:</b>  <a href="{% url 'get_UserProfile_page' petmatch.lost_pet.proposed_by.id %}">{{ petmatch.lost_pet.proposed_by.user.username }}</a></li>
            <li><b>Date {{ petmatch.lost_pet.status }} : </b>{{ petmatch.lost_pet.date_lost_or_found }}</li>
            <li><b>Location: </b>{{ petmatch.lost_pet.location }}</li>
            <li><b>Age:</b> {{ petmatch.lost_pet.age }} </li>
            <li><b>Sex:</b>  {{ petmatch.lost_pet.get_sex_display }}</li>
            <li><b>Breed:</b> {{ petmatch.lost_pet.breed }}</li>
            <li><b>Color:</b> {{ petmatch.lost_pet.color }}</li>
            <li><b>Size:</b> {{ petmatch.lost_pet.get_size_display }} </li>
            <li><b>Description:</b> <div class = "pr_desc" style="padding:2px; border:1px dotted black;"> {{ petmatch.lost_pet.description }}</div> </li>
          </ul>

        </div> 
        <!-- End Lost PetReport -->

        <!-- Found PetReport -->
        <div class = "pmdp_pet_container" style ="margin-right:5px;float:right;width:48%;">

          <!-- Found PetReport Title -->
          <div id="match_title">
            <div style="float:left"> {% if petmatch.found_pet.pet_name %} {{ petmatch.found_pet.pet_name }} {% endif %} </div>
            <div style="float:right"> {{ petmatch.found_pet.status }} </div>
          </div> <br/>

          <!-- Found PetReport Image -->
          <img src="{{ STATIC_URL }}{{ petmatch.found_pet.img_path }}"/>

          <!-- Found PetReport Info -->
          <ul>
            <li><b>Pet Name:</b> {{ petmatch.found_pet.pet_name }}</li>
            <li><b>Pet Type:</b> {{ petmatch.found_pet.pet_type }}</li>
            <li><b>Lost/Found:</b> {{ petmatch.found_pet.status }}</li>
            <li><b>Contact:</b> <a href="{% url 'get_UserProfile_page' petmatch.found_pet.proposed_by.id %}">{{ petmatch.found_pet.proposed_by.user.username }}</a></li>
            <li><b>Date {{ petmatch.found_pet.status }} : </b>{{ petmatch.found_pet.date_lost_or_found }}</li>
            <li><b>Location: </b>{{ petmatch.found_pet.location }}</li>
            <li><b>Age:</b> {{ petmatch.found_pet.age }} </li>
            <li><b>Sex:</b>  {{ petmatch.found_pet.get_sex_display }}</li>
            <li><b>Breed:</b> {{ petmatch.found_pet.breed }}</li>
            <li><b>Color:</b> {{ petmatch.found_pet.color }}</li>
            <li><b>Size:</b> {{ petmatch.found_pet.get_size_display }}</li>
            <li><b>Description:</b> <div class = "pr_desc" style="padding:2px; border:1px dotted black;"> {{ petmatch.found_pet.description }}</div> </li>
          </ul>

        </div>
        <!-- End Found PetReport -->
      </div> 
      <!-- end PMDP Match Container -->

      <div id = "pmdp_action_container">

        <div id="pmdp_votes_subtitle">
          <span id="pmdp_subtitle">People who have voted for this Pet Match </span>
          <div class="pmdp_vote_box" style="float:left;"> 
            <h3 style="margin-top:0px; margin-bottom:5px;"># Downvotes </h3>
            <h3 id="pmdp_downvote_number"> {{ num_downvotes }} </h3>
          </div>
          <div>
          </div>
          <div class="pmdp_vote_box" style="float:right;"> 
            <h3 style="margin-top:0px; margin-bottom:5px;"># Upvotes </h3>
            <h3 id= "pmdp_upvote_number"> {{ num_upvotes }}</h3>
          </div>
        </div>

        <!-- Need this for sending POST data -->
        {% csrf_token %}

        <div style="margin-top:5px;">

          <!-- Downvote Button -->
          <div style="float:left;">
            <img id= "pmdp_downvote_button" src="{{ STATIC_URL }}images/icons/button_downvote_active.png" alt="Downvote this Pet Match">
            </img>
          </div>

          <!-- UserBox Div -->
          <div id = "pmdp_userbox_container" style="width:85%">
            {% for worker in voters %}
              <div id = "pmdp_user_box">
                <a href= "{% url 'get_UserProfile_page' worker.id %}" title = "{{ worker.user.username }}">
                  {% if worker.photo %}    
                    <img src="{{ STATIC_URL }}{{ worker.photo }}" alt = "{{ worker.user.username }}"/>   
                  {% else %}
                    <img src="{{ STATIC_URL }}/images/defaults/anonymous.gif" alt = "{{ worker.user.username }}"/>
                  {% endif %}  
                </a>
              </div>
            {% endfor %}
          </div>

          <!-- Upvote Button -->
          <div style="float:right;">
            <img id = "pmdp_upvote_button" src= "{{ STATIC_URL }}images/icons/button_upvote_active.png" alt="Upvote this Pet Match">
            </img>
          </div>          

        </div>
      </div>

      <!-- Messages -->
      <ul id="messages" class="pmdp_messages">
        {% for message in messages %}
          <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
      </ul>              

    </div>
  </body>
</html>


{% load url from future %} <!-- Need this for forward (future) compatibility with django 1.5 and beyond. -->

<!DOCTYPE html>
<html class = 'no-js' lang = "en">
  <!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
  <!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
  <!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
  <!--[if gt IE 8]> <html class="no-js" lang="en"> <![endif]-->
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>{% block head_title %}Pet Report Detailed Page{% endblock head_title %}</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />

    <!-- CSS -->
    <link rel="stylesheet" href="{{ STATIC_URL }}css/style.css" type="text/css">
    <link rel="stylesheet" href="{{ STATIC_URL }}css/reset.css" type="text/css">
    <link rel="stylesheet" href="{{ STATIC_URL }}css/jquery-ui-1.8.css" type="text/css">
    <!-- Javascript & JQuery -->
    <script src="{{ STATIC_URL }}js/browserid-include.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/jquery-min.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/jquery-ui-min.js" type="text/javascript"></script>
    <!-- Include the BlockUI plugin -->
    <script src="{{ STATIC_URL }}js/BlockUI.js" type="text/javascript"></script>
    <!-- Include the hoverIntent plug-in -->
    <script src="{{ STATIC_URL }}js/jquery.hoverIntent.js" type="text/javascript"></script>
    <!-- Include the waypoints plug-in -->
     <script src="{{ STATIC_URL }}js/jquery.waypoints.js"></script>
    <!-- Include the imagesLoaded plug-in -->
    <script src="{{ STATIC_URL }}js/jquery.imagesloaded.js"></script>
    <!-- Include the plug-in -->
    <script src="{{ STATIC_URL }}js/jquery.wookmark.js"></script>
    
    <!-- Page-specific JS goes in this block -->
    {% block js %}
    <script type = 'text/javascript'>

      //This function allows us to prepare a popup upon clicking several elements.
      $(document).ready(function(){

        $("#prdp_petmatch_box a").click(function(){

          var link = $(this).attr("value");
          dialog_box = $("<div></div>").load(link).dialog ({

            position: "top",
            autoOpen: true,
            closeOnEscape: true,
            title: "Pet Match Detailed Page",
            width: 850,
            height: "auto",
            modal: true,
            resizable: false,
            show: {effect:"fade", duration:500},
            buttons: {"Close": function(){ $(this).dialog('close');} },
            close: function(event, ui){ 
              dialog_box.dialog('destroy').remove();
            }

          });
          return false;
        });

      });
    </script>
    <script type="text/javascript"> 
      function get_petreport_object (petreport_id, img){

        $.ajax({

          type:"POST",
          url:{{ bookmark_petreport }}
          success: function(data){
            var petreport = data;
            move_petreport_to_workspace_match_detail(petreport, img);
          },
          error: function(data){
            alert("An unexpected error occurred when trying to retrieve this Pet Report's attributes. Please try again."); 
            return false;
          }
        });
      }
    </script>


    {% endblock js %} 
  </head>
  <body>

    {%  block petreportcontent %}

      
      <div id="prdp_back"> 
           
          <!-- Share Buttons -->
          <div id="sharebuttons" style="float:right">
            <div style="float:left; margin-top:9px; margin-bottom:7px;">
              <font size=-1> Share on: </font>
            </div>
            <div style="float:left; margin:3px 0 0 7px;"> 

                <a title="Share on Facebook"
                   target='_blank' 
                   name="fb_share" 
                   type="button_count"
                   expr:share_url='data:post.url'  
                   href="http://www.facebook.com/sharer.php?s=100&p[url]=http://emergencypetmatcher.herokuapp.com:8000/reporting/PetReport/{{ pet_report.id }}/&p[images][0]={{ STATIC_URL }}{{ pet_report.img_path }}&p[title]=A Pet Report at EPM&p[summary]=A {{ pet_report.status }} {{ pet_report.pet_type }} Pet Report (Named: {{ pet_report.pet_name }}) has been proposed through EmergencyPetMatcher Website, a part of Project EPIC at University of Colorado at Boulder."
                   onclick="window.open('http://www.facebook.com/sharer.php?s=100&p[url]=http://emergencypetmatcher.herokuapp.com:8000/reporting/PetReport/{{ pet_report.id }}/&p[images][0]={{ STATIC_URL }}{{ pet_report.img_path }}&p[title]=A Pet Report at EPM&p[summary]=A {{ pet_report.status }} {{ pet_report.pet_type }} Pet Report (Named: {{ pet_report.pet_name }}) has been proposed through EmergencyPetMatcher Website, a part of Project EPIC at University of Colorado at Boulder.', 
                   'newWindow', 'width=700, height=430'); return false;"><img src="{{ STATIC_URL }}/images/icons/icn-facebook.png" width="22" height="22" /></a>

                  <a title="Share on Twitter" 
                    target="_blank" 
                    expr:share_url='data:post.url'
                    href="http://twitter.com/share?url=http://emergencypetmatcher.herokuapp.com:8000/reporting/PetReport/{{ pet_report.id }}/&text=A Pet Report at EPM. A {{ pet_report.status }} {{ pet_report.pet_type }} Pet Report (Named: {{ pet_report.pet_name }}) has been proposed through EmergencyPetMatcher Website, a part of Project EPIC at University of Colorado at Boulder." 
                    onclick="window.open('http://twitter.com/share?url=http://emergencypetmatcher.herokuapp.com:8000/reporting/PetReport/{{ pet_report.id }}/&text=A Pet Report at EPM. A {{ pet_report.status }} {{ pet_report.pet_type }} Pet Report (Named: {{ pet_report.pet_name }}) has been proposed through EmergencyPetMatcher Website, a part of Project EPIC at University of Colorado at Boulder.', 'newWindow', 'width=700, height=430'); return false;"><img src="{{ STATIC_URL }}/images/icons/icn-twitter.png" width="22" height="22"></a> 
              </div>
          </div>
    
        <!-- PRDP Title -->
        <div class="prdp_title">
          <!--  <div style="float:left"> 
            {% if pet_report.pet_name %} {{ pet_report.pet_name }} {% endif %} 
          </div> -->
          <div style="float:left;"> {{ pet_report.status }}</div>         
        </div>

        {% if messages %}
        <ul id="messages">
            {% for message in messages %}
            <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}        

        <!-- PRDP Image -->
		   <div class="prdp_picwrapper" > <img src="{{ STATIC_URL }}{{ pet_report.img_path }}"/><br/></div>
        <!-- Information pertaining to the PRDP -->
        <div class="prdp_info">
            <b>Pet Name:</b> {{ pet_report.pet_name }}<br/>
            <b>Lost/Found: </b> {{ pet_report.status }}<br/> 
            <b>Contact:</b>  {{  pet_report.proposed_by.user.username }}<br/>
            <b>Date {{ pet_report.status }} : </b>{{ pet_report.date_lost_or_found }}<br/>
            <b>Location:</b> {{ pet_report.location }}<br/>
            <b>Age:</b> {{ pet_report.age }}<br/> 
            <b>Sex:</b>  {{ pet_report.get_sex_display }}<br/>
            <b>Breed:</b> {{ pet_report.breed }} <br/> 
            <b>Color:</b> {{ pet_report.color }} <br/>
            <b>Size:</b> {{ pet_report.get_size_display }}<br/>
            <div class="pr_desc"><b>Description:</b> {{ pet_report.description }}<br></div>
        </div> 

        <!-- Proposed Pet Matches -->
        <div class="prdp_ppm_wk">
          <div class="prdp_subtitle"> Proposed Matches </div>

          {% for petmatch in matches  %}
            <div id = "prdp_petmatch_box"> 
              <a href = "#" class = "prdp_petmatch_link" value = "{% url 'display_PetMatch' petmatch.id %}">

                {% ifequal pet_report.status 'Lost' %}
                  <img class = "prdp_petmatch_img" src="{{ STATIC_URL}}{{ petmatch.found_pet.img_path }}" />
                {% else %}
                  <img class = "prdp_petmatch_img" src="{{ STATIC_URL}}{{ petmatch.lost_pet.img_path }}" />
                {% endifequal %}  

                <div id="prdp_user_box" style="float:right;">
                  <a href= "{% url 'get_UserProfile_page' petmatch.proposed_by.id %}"><!-- {{ petmatch.proposed_by.user.username }}  -->
                    {% if petmatch.proposed_by.photo %}    
                      <img src="{{ STATIC_URL }}{{ petmatch.proposed_by.photo }}" class = "prdp_worker_img" />   
                    {% else %}
                      <img src="{{ STATIC_URL }}/images/defaults/anonymous.gif" class = "prdp_worker_img" />
                    {% endif %}
                  </a>
                </div>

              </a>
            </div> 
          {% endfor %}

        </div>

        <!-- People Working on this Pet -->
        <div class="prdp_ppm_wk">
          <div class="prdp_subtitle"> People working on this pet </div>
            {% for worker in pet_report.workers.all  %}
              <div id = "prdp_user_box">
                <a href= "{% url 'get_UserProfile_page' worker.id %}" title = "{{ worker.user.username }}" >

                  {% if worker.photo %}    
                    <img src="{{ STATIC_URL }}{{ worker.photo }}" alt = "{{ worker.user.username }}" class = "prdp_worker_img" />   
                  {% else %}
                    <img src="{{ STATIC_URL }}/images/defaults/anonymous.gif" alt = "{{ worker.user.username }}"  class = "prdp_worker_img" />
                  {% endif %}
                </a>
              </div> 
            {% endfor %}
        </div> 

        <!-- Buttons -->
        <div id ="prdp_buttons">
          <a id = "prdp_eachbutton" href="#" style="float:left;" >Bookmark this Pet</a>
          <a id = "prdp_eachbutton" href="{% url 'match_PetReport' pet_report.id %}" style="float:right;" >Work on this Pet</a>
        </div>

      </div>
    {%  endblock petreportcontent %}
  </body>
</html>

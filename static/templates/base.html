{% load url from future %} <!-- Need this for forward (future) compatibility with django 1.5 and beyond. -->

<!DOCTYPE html>
<html class = 'no-js' lang = "en">
	<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
	<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
	<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
	<!--[if gt IE 8]> <html class="no-js" lang="en"> <![endif]-->
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>{% block head_title %} EmergencyPetMatcher (EPM) {% endblock head_title %}</title>
		<meta name="keywords" content="" />
		<meta name="description" content="" />

		<!-- CSS Reset -->
		<link rel="stylesheet" href="{{ STATIC_URL }}css/style.css">
		<link rel="stylesheet" href="{{ STATIC_URL }}css/reset.css">
		<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.17/themes/smoothness/jquery-ui.css">

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

		<!-- Include the hoverIntent plug-in -->
		<script src="{{ STATIC_URL }}js/jquery.hoverIntent.js" type="text/javascript"></script>
		<!-- Include the waypoints plug-in -->
		<script src="{{ STATIC_URL }}js/jquery.waypoints.js"></script>
		<!-- Include the imagesLoaded plug-in -->
		<script src="{{ STATIC_URL }}js/jquery.imagesloaded.js"></script>
		<!-- Include the plug-in -->
		<script src="{{ STATIC_URL }}js/jquery.wookmark.js"></script>

		<!-- General, inheritable JS goes here -->
		<script type="text/javascript"> </script>
		<!-- Page-specific JS goes in this block -->
		{% block js %}
		<script type = 'text/javascript'>

			//This function allows us to prepare a popup upon clicking several elements.
			$(document).ready(function(){
	
				//Upon clicking on the prdpdialog div, we open up a dialog box.
				
				/* NOTE: 'click()' replaced 'each()'. Maybe we can still do preliminary setting up
				of the dialog boxes WITHOUT loading the link, since loading the link means we are
				performing the GET request....  */
				$('#prdpdialog a').click(function(){
				
					var $link = $(this);
				    var $dialog = $('<li></li>')
						.load ($link.attr('href'))// + ' #prdpback')
						.dialog ({
						
							autoOpen: true,
							closeOnEscape: true,
							title: $link.attr('title'),
							height: "auto",
							modal: true,
							width: 700
							
					});
					
					$link.click(function(){
						//alert ("We are trying to execute this function");	
						$dialog.dialog('open');
						return false;
					});
				});

				$('#tiles').imagesLoaded(function() {
				
					// Prepare layout options.
					var options = {
						autoResize: true, // This will auto-update the layout when the browser window is resized.
						container: $('#container'), // Optional, used for some extra CSS styling
						offset: 2, // Optional, the distance between grid items
						itemWidth: 210 // Optional, the width of a grid item
					};
					
					// Get a reference to your grid items.
					var handler = $('#tiles li.item');
					// Call the layout function.
					handler.wookmark(options);
					
				});

				$(function(){

					var hand = 0;
					$("#hover1, #hover2, #toto").hoverIntent(
						function() {
							$(".hdetail", this).show();
							var h = $(this).height() + 30;
							hand.wookmark();
						},
						function() {
							
							var h = $(this).height() - 30;
							$(".hdetail", this).hide();
							hand.wookmark();
						}
					);					
				});
			});
		</script>
		{% endblock js %}			

		{% block headers %} {% endblock headers %}

	</head>
	<body>

		<!-- start header with TITLE and NAVIGATION MENU -->
		<div id="header">
			<div id="logo">
				<h1><a href="{% url 'home' %}">EmergencyPetMatcher</a></h1>
					<p> <a href = "http://epic.cs.colorado.edu"> Project EPIC </a></p>
			</div>

			<div id="menu">
				<ul>
					{% block menu %}
					<li><a href="{% url 'home' %}"> Home</a></li>

					{% if user.is_authenticated %}
					<li><a href= "{% url 'detail' user.id %}">{{ user.username }}</a></li>
						<form method = "post" action= "{% url 'logout' %}">
							{% csrf_token %} <input type="submit" value="Logout"/>
						</form>
					</li>
					<li><a href= "{% url 'submit_petreport' %}">Submit a Lost/Found Pet Report</a></li>
					<li><a href= "{% url 'matching' %}">Matching</a></li>
					{% else %}
					<li><a href= "{% url 'login_user' %}?next={% firstof request.path '/' %}">Login/Register</a></li>
					{% endif %}

					<li><a href="#">About</a></li>
					
					{% endblock menu %}
				</ul>
			</div>
		</div>
		<br/><br/><br/><br/>
		<!-- end header -->

		<!-- start page -->
		<div id="wrapper">
			<div id="main">

				<h2>{% block content_title %}{% endblock content_title %}</h2>
				<h3>{% block content_subtitle %}{% endblock content_subtitle %}</h3>
				<strong>					
					{% if messages %} 
    					{% for message in messages %} <p>{{ message }}</p> {% endfor %}
					{% endif %}
				</strong>		

				<!-- start content -->
				{% block content %}
				<div id="head">
					<header id="nav">
						<ul>
							<li><a href="#">Friends</a></li>
							<li class="active"><a href="#">Newly Added</a></li>
							<li><a href="#">Bookmarked</a></li>
							<li><a href="#">Advanced Search</a></li>
						</ul>
					</header>
				</div>
				<div id="container">
					<ul id="tiles">

						{% block friends_activity_feed %}
							<li class="item feed">
								<h3>Friends' Activity</h3>
								<ul class="feedlist"> <!-- <li>Josh improved 6 <a href="#">pet reports</a>. </li> --></ul>
							</li>
						{% endblock friends_activity_feed %}
		
						{% block pet_reports_content %}
							{% if pet_reports_list %}
								{% for pet_report in pet_reports_list %}
									<li class="item" id="prdpdialog"><a href= "{% url 'disp_petreport' pet_report.id %}">
										{% if pet_report.status %} Lost : {{ pet_report.pet_type }}
										{% else %} Found : {{ pet_report.pet_type }}
										{% endif %} <br />
										Contact : {{  pet_report.proposed_by.user.username}}
										{% if pet_report.img_path %}
											<img src="{{ STATIC_URL }}{{ pet_report.img_path }}"/>
										{% else %}
											{% ifequal pet_report.pet_type "Dog" %}
												<img src="{{ STATIC_URL }}images/defaults/dog_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Cat" %}
												<img src="{{ STATIC_URL }}images/defaults/cat_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Turtle" %}
												<img src="{{ STATIC_URL }}images/defaults/turtle_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Rabbit" %}
												<img src="{{ STATIC_URL }}images/defaults/rabbit_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Snake" %}
												<img src="{{ STATIC_URL }}images/defaults/snake_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Horse" %}
												<img src="{{ STATIC_URL }}images/defaults/horse_silhouette.jpg"/>
											{% endifequal %}
											{% ifequal pet_report.pet_type "Other" %}
												OTHER
											{% endifequal %}
										</li>
										{% endif %}
								{% endfor %}							
							{% else %}
							    <p>No pet reports are available.</p>
							{% endif %}
						{% endblock pet_reports_content %}
					</ul>	
				</div>
				<div class="pagination" align="center">
		   			<div class="step-links" id="footer" align="center">
		        				<div class="current" id="footer" align="left">
            		Page {{ pet_reports_list.number }} of {{ pet_reports_list.paginator.num_pages }}.
        		</div>
        		<div class="step-links" id="footer" align="left">	
        			{% if pet_reports_list.has_previous %}
           				<a href="?page={{ pet_reports_list.previous_page_number }}"> previous |</a>
        			{% endif %}

         			{% for i in pet_reports_list.paginator.page_range %}
           				<a href="?page={{ i }}"> {{ i }} | </a>
        			{% endfor %}
        			{% if pet_reports_list.has_next %}
            			<a href="?page={{ pet_reports_list.next_page_number }}"> next </a>
        			{% endif %}
        		</div>
		    	</div>

			<br style="clear: both;" />
				{% endblock content %}
			</div>
		</div>

		{% block chat %} 
		<div id="chat">	
		<!--implement chat here; chat should seamlessly always be part of all web pages. -->
		</div>
		{% endblock chat %}
		<!-- end page -->
		
		{% block footer %}
		<!-- start footer -->
		<footer id="footer">
			<p id="legal"> &copy;2012 Project EPIC . All Rights Reserved.
		</footer>
		{% endblock footer %}

	</body>
</html>

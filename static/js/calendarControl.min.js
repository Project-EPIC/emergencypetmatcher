function positionInfo(e){function t(){var e,t=0;for(e="object"==typeof s?s:document.getElementById(s);null!=e&&"relative"!=e.style.position;)t+=e.offsetLeft,e=e.offsetParent;return parseInt(t)}function r(){var e;return e="object"==typeof s?s:document.getElementById(s),parseInt(e.offsetWidth)}function a(){return t(s)+r(s)}function n(){var e,t=0;for(e="object"==typeof s?s:document.getElementById(s);null!=e&&"relative"!=e.style.position;)t+=e.offsetTop,e=e.offsetParent;return parseInt(t)}function o(){var e;return e="object"==typeof s?s:document.getElementById(s),parseInt(e.offsetHeight)}function i(){return n(s)+o(s)}var s=e;this.getElementLeft=t,this.getElementWidth=r,this.getElementRight=a,this.getElementTop=n,this.getElementHeight=o,this.getElementBottom=i}function CalendarControl(){function e(e,t,r){var a=r,n=null;n="object"==typeof a?a:document.getElementById(a),null!=n&&null!=n.style&&(n=n.style,n[e]=t)}function t(t,r){e(t,r,f)}function r(e,t){return[31,e%4||!(e%100)&&e%400?28:29,31,30,31,30,31,31,30,31,30,31][t-1]}function a(e,t,r){var a=new Date(e,t-1,r);return a.getDay()}function n(){R.value="",m()}function o(e,t,r){if(R){10>t&&(t="0"+t),10>r&&(r="0"+r);var a=t+"/"+r+"/"+e;R.value=a,m()}}function i(e){$+=e,g=0,$>12?($=1,v++):1>$&&($=12,v--),calendar=document.getElementById(f),calendar.innerHTML=u()}function s(e){v+=e,g=0,calendar=document.getElementById(f),calendar.innerHTML=u()}function d(){var e=(new Date).getYear();return 1900>e&&(e+=1900),e}function l(){return(new Date).getMonth()+1}function c(){return(new Date).getDate()}function u(){var e=1,t=0,n=a(v,$,e),o=r(v,$),i=null,s="<table cellspacing='0' cellpadding='0' border='0'>";s+="<tr class='header'>",s+="  <td colspan='2' class='previous'><a href='javascript:changeCalendarControlMonth(-1);'>&lt;</a> <a href='javascript:changeCalendarControlYear(-1);'>&laquo;</a></td>",s=s+"  <td colspan='3' class='title'>"+T[$-1]+"<br>"+v+"</td>",s+="  <td colspan='2' class='next'><a href='javascript:changeCalendarControlYear(1);'>&raquo;</a> <a href='javascript:changeCalendarControlMonth(1);'>&gt;</a></td>",s+="</tr>",s+="<tr><th>S</th><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th></tr>";for(var d=0;6>d;d++){s+="<tr>";for(var l=0;7>l;l++)0==d&&n==l?t=1:1==t&&e>o&&(t=0),t?(i=e==_&&v==D&&$==b?"current":0==l||6==l?"weekend":"weekday",s=s+"<td><a class='"+i+"' href=\"javascript:setCalendarControlDate("+v+","+$+","+e+')">'+e+"</a></td>",e++):s+="<td class='empty'>&nbsp;</td>";s+="</tr>"}return s+="<tr class='header'><th colspan='7' style='padding: 3px;'><a href='javascript:clearCalendarControl();'>Clear</a> | <a href='javascript:hideCalendarControl();'>Close</a></td></tr>",s+="</table>"}function p(r){if(w=0,R!=r){if(R=r)try{var a=new String(R.value),n=a.split("/");b=parseInt(n[0],10),_=parseInt(n[1],10),D=parseInt(n[2],10)}catch(o){}if(D&&b&&_||(b=l(),_=c(),D=d()),$=b,g=_,v=D,document.getElementById){calendar=document.getElementById(f),calendar.innerHTML=u(v,$),t("display","block");var i=new positionInfo(R),s=new positionInfo(f),p=i.getElementLeft(),m=i.getElementBottom();t("left",p+"px"),t("top",m+"px"),document.all&&(e("display","block","CalendarControlIFrame"),e("left",p+"px","CalendarControlIFrame"),e("top",m+"px","CalendarControlIFrame"),e("width",s.getElementWidth()+"px","CalendarControlIFrame"),e("height",s.getElementHeight()+"px","CalendarControlIFrame"))}}}function m(){R&&(t("display","none"),e("display","none","CalendarControlIFrame"),R=null)}function h(){return R}var f="CalendarControl",v=0,$=0,g=0,D=0,b=0,_=0,T=["January","February","March","April","May","June","July","August","September","October","November","December"],R=null;this.clearDate=n,this.setDate=o,this.changeMonth=i,this.changeYear=s,this.show=p,this.hide=m,this.visible=h,this.can_hide=w;var w=0}function showCalendarControl(e){calendarControl.show(e)}function clearCalendarControl(){calendarControl.clearDate()}function hideCalendarControl(){calendarControl.visible()&&calendarControl.hide()}function setCalendarControlDate(e,t,r){calendarControl.setDate(e,t,r)}function changeCalendarControlYear(e){calendarControl.changeYear(e)}function changeCalendarControlMonth(e){calendarControl.changeMonth(e)}var calendarControl=new CalendarControl;document.write("<iframe id='CalendarControlIFrame' src='javascript:false;' frameBorder='0' scrolling='no'></iframe>"),document.write("<div id='CalendarControl'></div>");
function refresh_layout(){var e={autoResize:!0,container:$("#tiles"),offset:10},t=$("#tiles li.item");$("#tiles li.item").draggable({zIndex:10,revert:"invalid",helper:"clone",stack:"#tiles .droppable"}),$(".droppable").droppable({hoverClass:"ui-state-active",accept:".item",drop:function(e,t){moveImage(t.draggable,$(this))}}),t.wookmark(e)}function moveImage(e,t){var n=$(e).find("img").clone(),i=$(e).find("a"),r=$(i).attr("identity");$.ajax({type:"GET",url:URL_GET_PETREPORT+r,success:function(e){var i=CANDIDATE_PETREPORT=e.petreport,r=t.width(),a=t.height();n.animate({height:a,width:r}),$(t).html(n),$("#button_propose_match").removeAttr("disabled"),$("#button_clear_candidate").removeAttr("disabled"),$("#button_clear_candidate").click(function(){$(t).html(""),$(t).append("<strong style='width:100%; margin-top:50%; display:inline-block; text-align:center; color:gray;'> Click and Drag a Pet Here </strong>"),$("#candidate_prdpfields").html(""),$("#target_prdpfields li").each(function(){$(this).css("color","black")}),$("#button_propose_match").prop("disabled",!0),$(this).prop("disabled",!0)}),$("#matching_workspace_candidate_img img").click(function(){load_dialog({link:URL_PRDP+CANDIDATE_PETREPORT.id,title:CANDIDATE_PETREPORT.pet_name,width:SIZE_WIDTH_PRDP})}),display_PetReport_fields({petreport:i,list:$("#candidate_prdpfields")}),highlight_matches($("#target_prdpfields"),$("#candidate_prdpfields"))},error:function(){alert("An unexpected error occurred when trying to get information for this Pet. Please try again.")}})}function fetch_PetReports(e){$("#tiles li.item").remove(),$("#tiles h3").remove(),$.ajax({type:"GET",url:URL_MATCHING+TARGET_PETREPORT.id+"/"+e,success:function(e){var t=e.pet_reports_list;e.count,e.total_count;for(var n=0;n<t.length;n++){var i=t[n],r=setup_petreport_item(i);$("#tiles").append(r)}0==t.length&&$("#tiles").append("<strong style='width:100%; display:inline-block; text-align:center;'> No Pets Available! </strong>"),refresh_layout()},error:function(){alert("An unexpected error occurred when trying to get Pet Reports. Please try again.")}})}function setup_petreport_item(e){var t=document.createElement("li"),n=document.createElement("a"),i=document.createElement("img");return $(t).addClass("item"),$(n).attr("name",e.pet_name),$(n).attr("link",URL_PRDP+e.ID),$(n).attr("identity",e.ID),$(n).on("click",function(){load_dialog({link:$(this).attr("link"),title:$(this).attr("name"),width:SIZE_WIDTH_PRDP})}),$(i).attr("src",STATIC_URL+e.img_path),$(i).width(150),$(i).height(150),$(i).css("margin","0 auto"),$(n).append("<strong style='display:block; text-align:center;'>"+e.pet_name+"</strong>"),$(n).append("<span style='display:block; text-align:center;'>Contact: "+e.proposed_by_username+"</span>"),$(n).append(i),$(t).append(n),t}$(document).ready(function(){$("#button_propose_match").click(function(){var e=URL_PROPOSE_MATCH+TARGET_PETREPORT.id+"/"+CANDIDATE_PETREPORT.id+"/";load_dialog({link:e,title:"Propose Match",width:900})}),$("#matching_workspace_target_img img").click(function(){load_dialog({link:URL_PRDP+TARGET_PETREPORT.id,title:TARGET_PETREPORT.pet_name,width:SIZE_WIDTH_PRDP})}),display_PetReport_fields({petreport:TARGET_PETREPORT,list:$("#target_prdpfields")}),$(".pagination").pagination({items:CANDIDATE_COUNT,itemsOnPage:50,cssStyle:"light-theme",onPageClick:function(e){fetch_PetReports(e)}});var e=$(".pagination").pagination("getPagesCount");e=e>10?10:e,$(".pagination_container").css("width",110+35*e),$(".pagination").pagination("redraw"),fetch_PetReports(1)});
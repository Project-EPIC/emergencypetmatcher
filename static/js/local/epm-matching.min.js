function refresh_layout(){var e={autoResize:!0,container:$("#tiles"),offset:10},t=$("#tiles li.item");$("#tiles li.item").draggable({zIndex:10,revert:"invalid",helper:"clone",stack:"#tiles .droppable"}),$(".droppable").droppable({hoverClass:"ui-state-active",accept:".item",drop:function(e,t){moveImage(t.draggable,$(this))}}),t.wookmark(e)}function moveImage(e,t){var i=$(e).find("img").clone(),n=$(e).find("a"),a=$(n).attr("identity");$.ajax({type:"GET",url:URL_GET_PETREPORT+a,success:function(e){var n=CANDIDATE_PETREPORT=e.petreport,a=t.width(),s=t.height();i.animate({height:s,width:a}),$(t).html(i),$("#button_propose_match").removeAttr("disabled"),$("#button_clear_candidate").removeAttr("disabled"),$("#button_clear_candidate").click(function(){$(t).html(""),$(t).append("<strong style='width:100%; margin-top:50%; display:inline-block; text-align:center; color:gray;'> Click and Drag a Pet Here </strong>"),$("#candidate_prdpfields").html(""),$("#target_prdpfields li").each(function(){$(this).css("color","black")}),$("#button_propose_match").prop("disabled",!0),$(this).prop("disabled",!0)}),$("#matching_workspace_candidate_img img").click(function(){load_dialog({link:URL_PRDP+CANDIDATE_PETREPORT.id,title:CANDIDATE_PETREPORT.pet_name,width:SIZE_WIDTH_PRDP})}),display_PetReport_fields({petreport:n,list:$("#candidate_prdpfields")}),highlight_field_matches($("#target_prdpfields"),$("#candidate_prdpfields"))},error:function(){alert("An unexpected error occurred when trying to get information for this Pet. Please try again.")}})}function fetch_PetReports(e){$("#tiles li.item").remove(),$("#tiles h3").remove(),$.ajax({type:"GET",url:URL_MATCHING+TARGET_PETREPORT.id+"/"+e,success:function(e){var t=e.pet_reports_list;e.count,e.total_count;for(var i=0;i<t.length;i++){var n=t[i],a=setup_petreport_item(n);$("#tiles").append(a)}0==t.length&&$("#tiles").append("<strong style='width:100%; display:inline-block; text-align:center;'> No Pets Available! </strong>"),refresh_layout()},error:function(){alert("An unexpected error occurred when trying to get Pet Reports. Please try again.")}})}function setup_petreport_item(e){var t=document.createElement("li"),i=document.createElement("a"),n=document.createElement("img");return $(t).addClass("item"),$(i).attr("name",e.pet_name),$(i).attr("link",URL_PRDP+e.ID),$(i).attr("identity",e.ID),$(i).on("click",function(){load_dialog({link:$(this).attr("link"),title:$(this).attr("name"),width:SIZE_WIDTH_PRDP})}),$(n).attr("src",STATIC_URL+e.img_path),$(n).width(150),$(n).height(150),$(n).css("margin","0 auto"),$(i).append("<strong style='display:block; text-align:center;'>"+e.pet_name+"</strong>"),$(i).append("<span style='display:block; text-align:center;'>Contact: "+e.proposed_by_username+"</span>"),$(i).append(n),$(t).append(i),t}$(document).ready(function(){$("#button_propose_match").click(function(){var e=URL_PROPOSE_MATCH+TARGET_PETREPORT.id+"/"+CANDIDATE_PETREPORT.id+"/";load_dialog({link:e,title:"Propose Match",width:800})}),$("#matching_workspace_target_img img").click(function(){load_dialog({link:URL_PRDP+TARGET_PETREPORT.id,title:TARGET_PETREPORT.pet_name,width:SIZE_WIDTH_PRDP})}),display_PetReport_fields({petreport:TARGET_PETREPORT,list:$("#target_prdpfields")}),$(".pagination").pagination({items:CANDIDATE_COUNT,itemsOnPage:50,cssStyle:"light-theme",onPageClick:function(e){fetch_PetReports(e)}});var e=$(".pagination").pagination("getPagesCount");e=e>10?10:e,$(".pagination_container").css("width",110+35*e),$(".pagination").pagination("redraw"),fetch_PetReports(1)});